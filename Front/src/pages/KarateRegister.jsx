import { useState, useRef } from "react";
import axios from "axios";
import styled from "styled-components";
import Paranoa from "../assets/logo-paranoa.png"
import Datawake from "../assets/logoDatawake.png"
import { AiOutlineExclamationCircle } from "react-icons/ai";
import SignatureCanvas from "react-signature-canvas";


const Container = styled.div`
    background-color: #3e3e3f;
    color: white;
    font-weight: 600;
    min-height: 100vh;

    .alertError {
        color: red;
        position: absolute;
        right: 10px;
        top: 73%;
        transform: translateY(-50%);
        pointer-events: none;
    }


    img{
        width: 200px;
    }

    .is-invalid {
        border: 2px solid red !important;
        border-radius: 4px;
    }


`
const ButtonBar = styled.div`
  display: flex;
  flex-wrap: wrap;         
  background-color: #222;
  width: 100%;
  border-radius: 8px; 
  padding: 10px;
  justify-content: center; 
`;



const NavButton = styled.button`
  flex: 1;
  padding: 5px 5px;
  background-color: ${(props) => (props.active ? "#fff" : "transparent")};
  color: ${(props) => (props.active ? "#000" : "#aaa")};
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 5px;

  &:hover {
    color: #fff;
    background-color: ${(props) => (props.active ? "#fff" : "#333")};
  }

  &:focus {
    outline: none;
  }

  &:disabled {
    cursor: not-allowed;
    opacity: 0.5; 
  }
`;

const Perfil = styled.img`
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 8px;
`
const AddImage = styled.button`
    background-color: #fbb514;
    color: black;
`



export default function KarateRegister() {
    const [form, setForm] = useState({

        nome: "",
        nascimento: "",
        email: "",
        rg: "",
        cpf: "",
        telefone: "",
        foto: null,
        camisa: "",
        chinelo: "",
        kimono: "",
        modalidade: "",
        modalidadeAnterior: "",
        funcionarioIndicando: "",
        telefoneFuncionario: "",
        parentesco: "",
        tratamentoSaude: "",
        tratamentoSaudeDetalhe: "",
        transtorno: "",
        transtornoDetalhe: "",
        cid: "",
        laudo: "",
        acompanhamento: "",
        medicamento: "",

        endereco: {
            cep: "",
            rua: "",
            numero: "",
            bairro: "",
            cidade: "",
            complemento: "",
            linhasOnibus: "",
            valorVT: ""
        },

        pai: {
            nome: "",
            telefone: "",
            rg: "",
            cpf: "",
            desempregado: "",
            profissao: "",
            email: ""
        },
        mae: {
            nome: "",
            telefone: "",
            rg: "",
            cpf: "",
            desempregada: "",
            profissao: "",
            email: ""
        },

        dataDeclaracao: ""
    });

    const [mostrar, setMostrar] = useState({
        tratamentoSaude: false,
        transtorno: false,
        medicamento: false,
        modalidade: false
    });

    const [etapa, setEtapa] = useState(1);
    const [previewFoto, setPreviewFoto] = useState(null);
    const [erros, setErros] = useState({});
    const sigCanvasAluno = useRef(null);
    const sigCanvasGerente = useRef(null);
    const sigCanvasProf = useRef(null);


    const proximaEtapa = () => {
        if (validarEtapa()) setEtapa((prev) => prev + 1);
    };
    const etapaAnterior = () => setEtapa((prev) => prev - 1);

    const getValue = (obj, path) => {
        return path.split('.').reduce((acc, key) => acc && acc[key], obj);
    };


    const validarEtapa = () => {
        const camposObrigatorios = {
            1: ["nome", "nascimento", "email", "rg", "cpf", "foto", "telefone", "modalidade", "funcionarioIndicando", "parentesco", "kimono", "chinelo", "camisa", "telefoneFuncionario"],
            2: ["transtorno", "tratamentoSaude", "medicamento"],
            3: ["endereco.cep", "endereco.rua", "endereco.numero", "endereco.bairro", "endereco.cidade", "endereco.linhasOnibus", "endereco.valorVT"],
            4: ["mae.nome", "mae.rg", "mae.cpf", "mae.telefone", "pai.nome", "pai.rg", "pai.cpf", "pai.telefone"],
            5: ["dataDeclaracao"]
        };

        if (mostrar.modalidade) {
            camposObrigatorios[1].push("modalidadeDetalhe");
        }

        const novosErros = {};

        camposObrigatorios[etapa]?.forEach((campo) => {
            const valor = getValue(form, campo);

            if (!valor || valor.toString().trim() === "" || valor == null) {
                novosErros[campo] = true;
            }
        });

        if (etapa === 5) {
            if (!sigCanvasAluno.current || sigCanvasAluno.current.isEmpty()) novosErros["assinaturaAluno"] = true;
            // if (!sigCanvasGerente.current || sigCanvasGerente.current.isEmpty()) novosErros["assinaturaGerente"] = true;
            // if (!sigCanvasProf.current || sigCanvasProf.current.isEmpty()) novosErros["assinaturaProf"] = true;
        }

        setErros(novosErros);

        if (Object.keys(novosErros).length > 0) {
            alert("Preencha todos os campos obrigatÃ³rios antes de prosseguir!");
            return false;
        }

        return true;
    };

    const etapaCompleta = (etapa) => {
        const camposObrigatorios = {
            1: ["nome", "nascimento", "email", "rg", "cpf", "telefone", "modalidade", "funcionarioIndicando", "parentesco", "kimono", "chinelo", "camisa", "telefoneFuncionario"],
            2: ["transtorno", "tratamentoSaude", "medicamento"],
            3: ["endereco.cep", "endereco.rua", "endereco.numero", "endereco.bairro", "endereco.cidade", "endereco.linhasOnibus", "endereco.valorVT"],
            4: ["mae.nome", "mae.rg", "mae.cpf", "mae.telefone", "pai.nome", "pai.rg", "pai.cpf", "pai.telefone"]
        };

        const faltando = camposObrigatorios[etapa]?.filter(
            (campo) => {
                const valor = getValue(form, campo);
                return !valor || valor.toString().trim() === "";
            }
        );

        return faltando.length === 0;
    };



    const handleRadioChange = (e) => {
        const { name, value } = e.target;

        setForm((prev) => ({
            ...prev,
            [name]: value,
        }));

        if (value === "Sim" || value === "ja_cursei") {
            setMostrar((prev) => ({ ...prev, [name]: true }));
        } else {
            setMostrar((prev) => ({ ...prev, [name]: false }));
            setForm((prev) => ({ ...prev, [`${name}Detalhe`]: "" }));
        }
    };





    const handleChange = (e) => {
        const { name, value } = e.target;

        let maskedValue = value;


        if (name === "cpf" || name.endsWith("cpf")) {
            maskedValue = value.replace(/\D/g, "")
                .replace(/(\d{3})(\d)/, "$1.$2")
                .replace(/(\d{3})(\d)/, "$1.$2")
                .replace(/(\d{3})(\d{1,2})$/, "$1-$2");
        } else if (name === "rg" || name.endsWith("rg")) {
            maskedValue = value.replace(/\D/g, "")
                .replace(/(\d{2})(\d)/, "$1.$2")
                .replace(/(\d{3})(\d)/, "$1.$2")
                .replace(/(\d{3})(\d)/, "$1-$2");
        } else if (name === "telefone" || name.endsWith("telefone")) {
            maskedValue = value.replace(/\D/g, "")
                .replace(/(\d{2})(\d)/, "($1) $2")
                .replace(/(\d{5})(\d)/, "$1-$2");
        } else if (name === "telefoneFuncionario" || name.endsWith("telefoneFuncionario")) {
            maskedValue = value.replace(/\D/g, "")
                .replace(/(\d{2})(\d)/, "($1) $2")
                .replace(/(\d{5})(\d)/, "$1-$2");
        } else if (name === "cep") {
            maskedValue = value.replace(/\D/g, "").replace(/(\d{5})(\d)/, "$1-$2");
        }

        if (name.includes(".")) {
            const [parent, field] = name.split(".");
            setForm({
                ...form,
                [parent]: { ...form[parent], [field]: maskedValue }
            });
        } else {
            setForm({ ...form, [name]: maskedValue });
        }
    };

    const handleCep = async (e) => {
        const cep = e.target.value.replace(/\D/g, "");
        if (cep.length === 8) {
            try {
                const res = await axios.get(`https://viacep.com.br/ws/${cep}/json/`);
                if (!res.data.erro) {
                    setForm(prev => ({
                        ...prev,
                        endereco: {
                            ...prev.endereco,
                            rua: res.data.logradouro,
                            bairro: res.data.bairro,
                            cidade: res.data.localidade
                        }
                    }));
                }
            } catch (error) {
                console.error("Erro ao buscar CEP:", error);
            }
        }
    };

    const handleSubmit = async (e) => {
        e.preventDefault();

        if (!validarEtapa()) return;

        const formDataToSend = new FormData();

        // Campos de texto/objetos
        Object.entries(form).forEach(([key, value]) => {
            if (typeof value === "object" && value !== null) {
                formDataToSend.append(key, JSON.stringify(value));
            } else {
                formDataToSend.append(key, value);
            }
        });

        // Foto do aluno
        if (form.foto) {
            formDataToSend.append("foto", form.foto);
        }

        // Assinaturas em base64
        if (sigCanvasAluno.current) {
            const alunoData = sigCanvasAluno.current.toDataURL("image/png");
            formDataToSend.append("assinaturaAluno", alunoData);
        }
        if (sigCanvasGerente.current) {
            const gerenteData = sigCanvasGerente.current.toDataURL("image/png");
            formDataToSend.append("assinaturaGerente", gerenteData);
        }
        if (sigCanvasProf.current) {
            const profData = sigCanvasProf.current.toDataURL("image/png");
            formDataToSend.append("assinaturaProf", profData);
        }

        try {
            const res = await axios.post(
                "https://escolinha.paranoa.com.br/api/acronis/formulario",
                formDataToSend,
                {
                    headers: { "Content-Type": "multipart/form-data" }
                }
            );
            console.log(res.data);
        } catch (err) {
            console.error(err);
        }
    };





    const handleFotoChange = (e) => {
        const file = e.target.files[0];

        if (!file) return;

        if (!file.type.startsWith("image/")) {
            alert("Por favor, selecione uma imagem vÃ¡lida (JPG, PNG, etc.)");
            return;
        }


        setForm((prev) => ({ ...prev, foto: file }));


        const previewURL = URL.createObjectURL(file);
        setPreviewFoto(previewURL);

        setErros((prev) => {
            const { foto, ...rest } = prev;
            return rest;
        });
    };



    return (
        <Container>
            <div className="container d-flex justify-content-center text-center justify-content-start  pt-5 mb-5">
                <div className="row mt-5">
                    <div className="col-md-5">
                        <img src={Paranoa} alt="" className="img-fluid ml-3" />
                    </div>
                    <div className="col-md-5">
                        <img src={Datawake} alt="" className="img-fluid" />
                    </div>


                </div>

            </div>
            <div className="container py-4">

                <h1 className="text-center mb-4">FICHA DE INSCRIÃÃO - KARATÃ</h1>
                <form onSubmit={handleSubmit}>
                    <div className="form-row mt-5 mb-5 d-flex justify-content-center sticky-top">
                        <ButtonBar className="mt-4 mb-4 mt-md-1 mb-md-1">
                            <NavButton
                                active={etapa === 1}
                                style={{ backgroundColor: etapaCompleta(1) ? "#84fa84" : undefined }}
                                onClick={() => setEtapa(1)}
                                disabled={etapa < 1}
                            >
                                Candidato
                            </NavButton>

                            <NavButton
                                active={etapa === 2}
                                style={{ backgroundColor: etapaCompleta(2) ? "#84fa84" : undefined }}
                                onClick={() => setEtapa(2)}
                                disabled={etapa < 2}
                            >
                                SaÃºde
                            </NavButton>

                            <NavButton
                                active={etapa === 3}
                                style={{ backgroundColor: etapaCompleta(3) ? "#84fa84" : undefined }}
                                onClick={() => setEtapa(3)}
                                disabled={etapa < 3}
                            >
                                EndereÃ§o
                            </NavButton>

                            <NavButton
                                active={etapa === 4}
                                style={{ backgroundColor: etapaCompleta(4) ? "#84fa84" : undefined }}
                                onClick={() => setEtapa(4)}
                                disabled={etapa < 4}
                            >
                                Familiares
                            </NavButton>
                        </ButtonBar>


                    </div>


                    {etapa === 1 && (
                        <>

                            <div className="form-row">
                                <div className="form-group col-md-6" style={{ position: "relative" }}>
                                    <label>Nome Completo</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        name="nome"
                                        value={form.nome}
                                        onChange={handleChange}
                                        style={{ borderColor: erros["nome"] ? "red" : undefined }}
                                    />
                                    {erros["nome"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>Data de Nascimento</label>
                                    <input type="date" className="form-control" name="nascimento" value={form.nascimento} onChange={handleChange} style={{ borderColor: erros["nascimento"] ? "red" : undefined }} />
                                    {erros["nascimento"] && (
                                        <AiOutlineExclamationCircle
                                            style={{
                                                color: "red",
                                                position: "absolute",
                                                right: "40px",
                                                top: "73%",
                                                transform: "translateY(-50%)",
                                                pointerEvents: "none"
                                            }}
                                        />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>E-mail</label>
                                    <input type="email" className="form-control" name="email" value={form.email} onChange={handleChange} style={{ borderColor: erros["email"] ? "red" : undefined }} />
                                    {erros["email"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-3">
                                    <label>RG</label>
                                    <input type="text" className="form-control" name="rg" value={form.rg} onChange={handleChange} maxLength="12" style={{ borderColor: erros["rg"] ? "red" : undefined }} />
                                    {erros["rg"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>CPF</label>
                                    <input type="text" className="form-control" name="cpf" value={form.cpf} onChange={handleChange} maxLength="14" style={{ borderColor: erros["cpf"] ? "red" : undefined }} />
                                    {erros["cpf"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>Telefone/Celular</label>
                                    <input type="text" className="form-control" name="telefone" value={form.telefone} onChange={handleChange} maxLength="15" style={{ borderColor: erros["telefone"] ? "red" : undefined }} />
                                    {erros["telefone"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>Tamanho do Kimono</label>
                                    <input type="text" className="form-control" name="kimono" value={form.kimono} onChange={handleChange} style={{ borderColor: erros["kimono"] ? "red" : undefined }} />
                                    {erros["kimono"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>


                            <div className="form-row mt-4 mb-4">
                                <div className="form-group col-md-6" style={{ position: "relative", border: erros["foto"] ? "1px solid red" : "none", padding: "10px", borderRadius: "6px" }}>
                                    <label>Adicione uma Foto do Rosto com Fundo Branco</label> <br />

                                    <AddImage
                                        type="button"
                                        className="btn"
                                        onClick={() => document.getElementById("fotoInput").click()}
                                    >
                                        Escolher arquivo
                                    </AddImage>


                                    <input
                                        type="file"
                                        id="fotoInput"
                                        accept="image/*"
                                        onChange={handleFotoChange}
                                        style={{ display: "none", }}
                                        name="foto"
                                    />

                                    {erros["foto"] && <AiOutlineExclamationCircle className="alertError" />}

                                    {previewFoto && (
                                        <div className="mt-3">
                                            <Perfil
                                                src={previewFoto}
                                                alt="PrÃ©via da foto"
                                                style={{
                                                    border: erros["foto"] ? "2px solid red" : "2px solid #ccc",
                                                }}
                                            />
                                        </div>
                                    )}
                                </div>

                            </div>


                            <div className="form-row">
                                <div className="form-group col-md-6">
                                    <label>Tamanho da Camisa</label>
                                    <input type="text" className="form-control" name="camisa" value={form.camisa} onChange={handleChange} style={{ borderColor: erros["camisa"] ? "red" : undefined }} />
                                    {erros["camisa"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-6">
                                    <label>Tamanho do Chinelo</label>
                                    <input type="text" className="form-control" name="chinelo" value={form.chinelo} onChange={handleChange} style={{ borderColor: erros["chinelo"] ? "red" : undefined }} />
                                    {erros["chinelo"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>

                            </div>

                            <div
                                className="form-group"
                                style={{
                                    position: "relative",
                                    border: erros["modalidade"] ? "1px solid red" : "1px solid transparent",
                                    borderRadius: "6px",
                                    padding: "8px",
                                }}
                            >
                                <label className="mr-2">JÃ¡ cursou a modalidade antes?</label> <br />

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="modalidade"
                                            value="iniciante"
                                            checked={form.modalidade === "iniciante"}
                                            onChange={handleRadioChange}
                                        />
                                        Iniciante
                                    </label>
                                </div>

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="modalidade"
                                            value="ja_cursei"
                                            checked={form.modalidade === "ja_cursei"}
                                            onChange={handleRadioChange}
                                        />
                                        JÃ¡ cursei
                                    </label>
                                </div>


                                {erros["modalidade"] && (
                                    <AiOutlineExclamationCircle className="alertError" />
                                )}


                                {mostrar.modalidade && (
                                    <input
                                        type="text"
                                        name="modalidadeDetalhe"
                                        value={form.modalidadeDetalhe}
                                        onChange={handleChange}
                                        className={`form-control mt-2 ${erros["modalidadeDetalhe"] ? "is-invalid" : ""
                                            }`}
                                        placeholder="Qual faixa estÃ¡?"
                                    />
                                )}
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-6">
                                    <label>Nome do FuncionÃ¡rio que estÃ¡ indicando</label>
                                    <input type="text" className="form-control" name="funcionarioIndicando" value={form.funcionarioIndicando} onChange={handleChange} style={{ borderColor: erros["funcionarioIndicando"] ? "red" : undefined }} />
                                    {erros["funcionarioIndicando"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>Telefone/Celular</label>
                                    <input type="text" className="form-control" name="telefoneFuncionario" value={form.telefoneFuncionario} onChange={handleChange} maxLength="15" style={{ borderColor: erros["telefoneFuncionario"] ? "red" : undefined }} />
                                    {erros["telefoneFuncionario"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>

                                <div className="form-group col-md-3">
                                    <label>Grau de Parentesco</label>
                                    <input type="text" className="form-control" name="parentesco" value={form.parentesco} onChange={handleChange} style={{
                                        borderColor: erros["parentesco"] ? "red" : undefined,
                                        paddingRight: erros["parentesco"] ? "30px" : undefined
                                    }} />

                                    {erros["parentesco"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <button type="button" className="btn btn-success mt-3 mr-3" onClick={proximaEtapa}>
                                Continuar
                            </button>

                        </>
                    )}


                    {etapa === 2 && (
                        <>
                            {/* Tratamento de saÃºde */}
                            <div
                                className="form-group"
                                style={{
                                    position: "relative",
                                    border: erros["tratamentoSaude"]
                                        ? "1px solid red"
                                        : "1px solid transparent",
                                    borderRadius: "6px",
                                    padding: "8px",
                                }}
                            >
                                <label className="mr-1">Faz algum tratamento de saÃºde?</label> <br />

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            type="radio"
                                            name="tratamentoSaude"
                                            value="NÃ£o"
                                            onChange={handleRadioChange}
                                            checked={form.tratamentoSaude === "NÃ£o"}
                                            className="form-check-input"
                                        />
                                        NÃ£o
                                    </label>
                                </div>

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            type="radio"
                                            name="tratamentoSaude"
                                            value="Sim"
                                            onChange={handleRadioChange}
                                            checked={form.tratamentoSaude === "Sim"}
                                            className="form-check-input"
                                        />
                                        Sim
                                    </label>
                                </div>

                                {erros["tratamentoSaude"] && (
                                    <AiOutlineExclamationCircle className="alertError" />
                                )}

                                {mostrar.tratamentoSaude && (
                                    <input
                                        type="text"
                                        name="tratamentoSaudeDetalhe"
                                        value={form.tratamentoSaudeDetalhe}
                                        onChange={handleChange}
                                        className={`form-control mt-2 ${erros["tratamentoSaudeDetalhe"] ? "is-invalid" : ""
                                            }`}
                                        placeholder="Qual tratamento?"
                                    />
                                )}
                            </div>


                            <div
                                className="form-group"
                                style={{
                                    position: "relative",
                                    border: erros["transtorno"] ? "1px solid red" : "1px solid transparent",
                                    borderRadius: "6px",
                                    padding: "8px",
                                }}
                            >
                                <label className="mr-1">Possui algum transtorno?</label> <br />

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="transtorno"
                                            value="NÃ£o"
                                            checked={form.transtorno === "NÃ£o"}
                                            onChange={handleRadioChange}
                                        />
                                        NÃ£o
                                    </label>
                                </div>

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="transtorno"
                                            value="Sim"
                                            checked={form.transtorno === "Sim"}
                                            onChange={handleRadioChange}
                                        />
                                        Sim
                                    </label>
                                </div>

                                {erros["transtorno"] && (
                                    <AiOutlineExclamationCircle className="alertError" />
                                )}

                                {mostrar.transtorno && (
                                    <>
                                        <input
                                            type="text"
                                            className={`form-control mt-2 ${erros["transtornoDetalhe"] ? "is-invalid" : ""
                                                }`}
                                            name="transtornoDetalhe"
                                            value={form.transtornoDetalhe}
                                            onChange={handleChange}
                                            placeholder="Qual transtorno?"
                                        />

                                        <div className="form-row mt-2">
                                            <div
                                                className="form-group col-md-6"
                                                style={{
                                                    border: erros["laudo"] ? "1px solid red" : "1px solid transparent",
                                                    borderRadius: "6px",
                                                    padding: "6px",
                                                    position: "relative",
                                                }}
                                            >
                                                <label>Possui Laudo MÃ©dico?</label>
                                                <div className="form-check form-check-inline">
                                                    <label className="form-check-label">
                                                        <input
                                                            className="form-check-input"
                                                            type="radio"
                                                            name="laudo"
                                                            value="Sim"
                                                            checked={form.laudo === "Sim"}
                                                            onChange={handleRadioChange}
                                                        />
                                                        Sim
                                                    </label>
                                                </div>
                                                <div className="form-check form-check-inline">
                                                    <label className="form-check-label">
                                                        <input
                                                            className="form-check-input"
                                                            type="radio"
                                                            name="laudo"
                                                            value="NÃ£o"
                                                            checked={form.laudo === "NÃ£o"}
                                                            onChange={handleRadioChange}
                                                        />
                                                        NÃ£o
                                                    </label>
                                                </div>

                                                {erros["laudo"] && (
                                                    <AiOutlineExclamationCircle className="alertError" />
                                                )}
                                            </div>
                                        </div>

                                        {mostrar.laudo && (
                                            <>
                                                <div className="form-group col-md-6">
                                                    <label>Qual CID (nÂ°)?</label>
                                                    <input
                                                        type="text"
                                                        className={`form-control ${erros["cid"] ? "is-invalid" : ""
                                                            }`}
                                                        name="cid"
                                                        value={form.cid}
                                                        onChange={handleChange}
                                                    />
                                                </div>
                                                <div className="form-group">
                                                    <label>Acompanhamento com especialista:</label>
                                                    <input
                                                        type="text"
                                                        className={`form-control ${erros["acompanhamento"] ? "is-invalid" : ""
                                                            }`}
                                                        name="acompanhamento"
                                                        value={form.acompanhamento}
                                                        onChange={handleChange}
                                                    />
                                                </div>
                                            </>
                                        )}
                                    </>
                                )}
                            </div>


                            <div
                                className="form-group"
                                style={{
                                    position: "relative",
                                    border: erros["medicamento"] ? "1px solid red" : "1px solid transparent",
                                    borderRadius: "6px",
                                    padding: "8px",
                                }}
                            >
                                <label className="mr-2">Faz uso de algum medicamento contÃ­nuo?</label> <br />

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="medicamento"
                                            value="NÃ£o"
                                            checked={form.medicamento === "NÃ£o"}
                                            onChange={handleRadioChange}
                                        />
                                        NÃ£o
                                    </label>
                                </div>

                                <div className="form-check form-check-inline">
                                    <label className="form-check-label">
                                        <input
                                            className="form-check-input"
                                            type="radio"
                                            name="medicamento"
                                            value="Sim"
                                            checked={form.medicamento === "Sim"}
                                            onChange={handleRadioChange}
                                        />
                                        Sim
                                    </label>
                                </div>

                                {erros["medicamento"] && (
                                    <AiOutlineExclamationCircle className="alertError" />
                                )}

                                {mostrar.medicamento && (
                                    <input
                                        type="text"
                                        className={`form-control mt-2 ${erros["medicamentoDetalhe"] ? "is-invalid" : ""
                                            }`}
                                        name="medicamentoDetalhe"
                                        value={form.medicamentoDetalhe}
                                        onChange={handleChange}
                                        placeholder="Qual medicamento?"
                                    />
                                )}
                            </div>

                            <button
                                type="button"
                                className="btn btn-danger mt-3 mr-3"
                                onClick={etapaAnterior}
                            >
                                Retornar
                            </button>

                            <button
                                type="button"
                                className="btn btn-success mt-3 mr-3"
                                onClick={proximaEtapa}
                            >
                                Continuar
                            </button>
                        </>

                    )}


                    {etapa === 3 && (
                        <>

                            <div className="form-row">
                                <div className="form-group col-md-3">
                                    <label>CEP</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        name="endereco.cep"
                                        value={form.endereco.cep}
                                        onChange={(e) => { handleChange(e); handleCep(e); }}
                                        maxLength="9"
                                        style={{ borderColor: erros["endereco.rua"] ? "red" : undefined }}
                                    />
                                    {erros["endereco.cep"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-6">
                                    <label>EndereÃ§o</label>
                                    <input type="text" className="form-control" name="endereco.rua" value={form.endereco.rua} onChange={handleChange} style={{ borderColor: erros["endereco.rua"] ? "red" : undefined }} />
                                    {erros["endereco.rua"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>NÃºmero</label>
                                    <input type="number" className="form-control" name="endereco.numero" value={form.endereco.numero} onChange={handleChange} style={{ borderColor: erros["endereco.numero"] ? "red" : undefined }} />
                                    {erros["endereco.numero"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-4">
                                    <label>Bairro</label>
                                    <input type="text" className="form-control" name="endereco.bairro" value={form.endereco.bairro} onChange={handleChange} style={{ borderColor: erros["endereco.bairro"] ? "red" : undefined }} />
                                    {erros["endereco.bairro"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-4">
                                    <label>Cidade</label>
                                    <input type="text" className="form-control" name="endereco.cidade" value={form.endereco.cidade} onChange={handleChange} style={{ borderColor: erros["endereco.cidade"] ? "red" : undefined }} />
                                    {erros["endereco.cidade"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-4">
                                    <label>Complemento</label>
                                    <input type="text" className="form-control" name="endereco.complemento" value={form.endereco.complemento} onChange={handleChange} style={{ borderColor: erros["endereco.complemento"] ? "red" : undefined }} />
                                    {erros["endereco.complemento"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-6">
                                    <label>Linhas de Ãnibus que possui acesso</label>
                                    <input type="text" className="form-control" name="endereco.linhasOnibus" value={form.endereco.linhasOnibus} onChange={handleChange} style={{ borderColor: erros["endereco.linhasOnibus"] ? "red" : undefined }} />
                                    {erros["endereco.linhasOnibus"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>

                                <div className="form-group col-md-6">
                                    <div className="form-group">
                                        <label>Valor total diÃ¡rio VT R$ (ida e volta)</label>
                                        <input type="number" className="form-control" name="endereco.valorVT" value={form.endereco.valorVT} onChange={handleChange} style={{ borderColor: erros["endereco.valorVT"] ? "red" : undefined }} />
                                        {erros["endereco.linhasOnibus"] && (
                                            <AiOutlineExclamationCircle className="alertError" />
                                        )}
                                    </div>
                                </div>

                            </div>

                            <button type="button" className="btn btn-danger mt-3 mr-3" onClick={etapaAnterior}>
                                Retornar
                            </button>

                            <button type="button" className="btn btn-success mt-3 mr-3" onClick={proximaEtapa}>
                                Continuar
                            </button>
                        </>

                    )}

                    {etapa === 4 && (
                        <>



                            <h5>Pai</h5>
                            <div className="form-row">
                                <div className="form-group col-md-6">
                                    <label>Nome do Pai</label>
                                    <input type="text" className="form-control" name="pai.nome" value={form.pai.nome} onChange={handleChange} style={{ borderColor: erros["pai.nome"] ? "red" : undefined }} />
                                    {erros["pai.nome"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-6">
                                    <label>Telefone/Celular</label>
                                    <input type="text" className="form-control" name="pai.telefone" value={form.pai.telefone} onChange={handleChange} maxLength="15" style={{ borderColor: erros["pai.telefone"] ? "red" : undefined }} />
                                    {erros["pai.telefone"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-3">
                                    <label>RG</label>
                                    <input type="text" className="form-control" name="pai.rg" value={form.pai.rg} onChange={handleChange} maxLength="12" style={{ borderColor: erros["pai.rg"] ? "red" : undefined }} />
                                    {erros["pai.rg"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>CPF</label>
                                    <input type="text" className="form-control" name="pai.cpf" value={form.pai.cpf} onChange={handleChange} maxLength="14" style={{ borderColor: erros["pai.cpf"] ? "red" : undefined }} />
                                    {erros["pai.cpf"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3 text-center">
                                    <label className="mr-2">Desempregado</label> <br />
                                    <div className="form-check form-check-inline">
                                        <label className="form-check-label">
                                            <input className="form-check-input" type="radio" name="pai.desempregado" value="Sim" onChange={handleChange} />
                                            Sim</label>
                                    </div>
                                    <div className="form-check form-check-inline">
                                        <label className="form-check-label">
                                            <input className="form-check-input" type="radio" name="pai.desempregado" value="NÃ£o" onChange={handleChange} />
                                            NÃ£o</label>
                                    </div>
                                </div>
                                <div className="form-group col-md-3">
                                    <label>ProfissÃ£o</label>
                                    <input type="text" className="form-control" name="pai.profissao" value={form.pai.profissao} onChange={handleChange} style={{ borderColor: erros["pai.profissao"] ? "red" : undefined }} />
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Email</label>
                                <input type="email" className="form-control" name="pai.email" value={form.pai.email} onChange={handleChange} style={{ borderColor: erros["pai.email"] ? "red" : undefined }} />
                                {erros["pai.email"] && (
                                    <AiOutlineExclamationCircle
                                        style={{
                                            color: "red",
                                            position: "absolute",
                                            right: "10px",
                                            top: "73%",
                                            transform: "translateY(-50%)",
                                            pointerEvents: "none"
                                        }}
                                    />
                                )}
                            </div>

                            <h5 className="mt-5">MÃ£e</h5>
                            <div className="form-row">
                                <div className="form-group col-md-6">
                                    <label>Nome da MÃ£e</label>
                                    <input type="text" className="form-control" name="mae.nome" value={form.mae.nome} onChange={handleChange} style={{ borderColor: erros["mae.nome"] ? "red" : undefined }} />
                                    {erros["mae.nome"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-6">
                                    <label>Telefone/Celular</label>
                                    <input type="text" className="form-control" name="mae.telefone" value={form.mae.telefone} onChange={handleChange} maxLength="15" style={{ borderColor: erros["mae.telefone"] ? "red" : undefined }} />
                                    {erros["mae.telefone"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                            </div>

                            <div className="form-row">
                                <div className="form-group col-md-3">
                                    <label>RG</label>
                                    <input type="text" className="form-control" name="mae.rg" value={form.mae.rg} onChange={handleChange} maxLength="12" style={{ borderColor: erros["mae.rg"] ? "red" : undefined }} />
                                    {erros["mae.rg"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3">
                                    <label>CPF</label>
                                    <input type="text" className="form-control" name="mae.cpf" value={form.mae.cpf} onChange={handleChange} maxLength="14" style={{ borderColor: erros["mae.cpf"] ? "red" : undefined }} />
                                    {erros["mae.cpf"] && (
                                        <AiOutlineExclamationCircle className="alertError" />
                                    )}
                                </div>
                                <div className="form-group col-md-3 text-center">
                                    <label className="mr-2">Desempregada</label> <br />
                                    <div className="form-check form-check-inline">
                                        <label className="form-check-label">
                                            <input className="form-check-input" type="radio" name="mae.desempregada" value="Sim" onChange={handleChange} />
                                            Sim</label>
                                    </div>
                                    <div className="form-check form-check-inline">
                                        <label className="form-check-label">
                                            <input className="form-check-input" type="radio" name="mae.desempregada" value="NÃ£o" onChange={handleChange} />
                                            NÃ£o</label>
                                    </div>
                                </div>
                                <div className="form-group col-md-3">
                                    <label>ProfissÃ£o</label>
                                    <input type="text" className="form-control" name="mae.profissao" value={form.mae.profissao} onChange={handleChange} style={{ borderColor: erros["mae.profissao"] ? "red" : undefined }} />
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Email</label>
                                <input type="email" className="form-control" name="mae.email" value={form.mae.email} onChange={handleChange} style={{ borderColor: erros["mae.email"] ? "red" : undefined }} />
                                {erros["mae.email"] && (
                                    <AiOutlineExclamationCircle
                                        style={{
                                            color: "red",
                                            position: "absolute",
                                            right: "10px",
                                            top: "73%",
                                            transform: "translateY(-50%)",
                                            pointerEvents: "none"
                                        }}
                                    />
                                )}
                            </div>
                            <button type="button" className="btn btn-danger mt-3 mr-3" onClick={etapaAnterior}>
                                Retornar
                            </button>

                            <button type="button" className="btn btn-success mt-3 mr-3" onClick={proximaEtapa}>
                                Continuar
                            </button>
                        </>
                    )}

                    {etapa === 5 && (
                        <>
                            <div className="form-group mt-4">
                                <p>
                                    Declaro a veracidade das informaÃ§Ãµes anteriormente declarada. <br />
                                    Estou ciente que este Ã© um benefÃ­cio da empresa e que posso utilizar durante todo o perÃ­odo vigente do contrato de trabalho acordado. <br /><br />
                                    Diadema,{" "}
                                    <input
                                        type="date"
                                        className="form-control d-inline-block w-auto ml-2"
                                        name="dataDeclaracao"
                                        value={form.dataDeclaracao}
                                        onChange={handleChange}
                                        style={{
                                            border: erros["dataDeclaracao"] ? "2px solid red" : "1px solid #ccc",
                                            borderRadius: "4px",
                                        }}
                                    />
                                    {erros["dataDeclaracao"] && (
                                        <AiOutlineExclamationCircle style={{ color: "red", marginLeft: "5px" }} />
                                    )}

                                </p>
                            </div>

                            <div className="row mt-4">

                                <div className="col-12 col-md-6 mb-4" style={{ position: "relative" }}>
                                    <div className="text-center">
                                        <SignatureCanvas
                                            ref={sigCanvasAluno}
                                            penColor="black"
                                            canvasProps={{
                                                className: `border w-100 ${erros["assinaturaAluno"] ? "border-danger" : ""}`,
                                                height: 150
                                            }}
                                        />
                                        {erros["assinaturaAluno"] && (
                                            <AiOutlineExclamationCircle className="alertError" />
                                        )}
                                        <small className="d-block mt-2">Assinatura Aluno(a) ou ResponsÃ¡vel</small>
                                        <button type="button" className="btn btn-sm btn-warning mt-2" onClick={() => sigCanvasAluno.current.clear()}>Limpar</button>
                                    </div>
                                </div>



                                <div className="col-12 col-md-6 mb-4">
                                    <div className="text-center">
                                        <SignatureCanvas
                                            ref={sigCanvasGerente}
                                            penColor="black"
                                            canvasProps={{ className: "border w-100", height: 150 }}
                                        />
                                        <small className="d-block mt-2">Assinatura Gerente (Thais Muller Xavier)</small>
                                        <button
                                            type="button"
                                            className="btn btn-sm btn-warning mt-2"
                                            onClick={() => sigCanvasGerente.current.clear()}
                                        >
                                            Limpar
                                        </button>
                                    </div>
                                </div>


                                <div className="col-12 col-md-6 mb-4">
                                    <div className="text-center">
                                        <SignatureCanvas
                                            ref={sigCanvasProf}
                                            penColor="black"
                                            canvasProps={{ className: "border w-100", height: 150 }}
                                        />
                                        <small className="d-block mt-2">Profissional Educacional (Quezia Arruda)</small>
                                        <button
                                            type="button"
                                            className="btn btn-sm btn-warning mt-2"
                                            onClick={() => sigCanvasProf.current.clear()}
                                        >
                                            Limpar
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="text-center mt-4">
                                <button type="submit" className="btn btn-primary px-5">Enviar InscriÃ§Ã£o</button>
                            </div>
                        </>
                    )}



                </form>
            </div>
        </Container>
    );
}
